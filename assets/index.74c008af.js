import{h as j,d as F,r as W,J as G,aM as ue,k as re,L as f,l as J,O as P,aE as ve,aN as fe,aO as he,P as Q,aF as de,aG as ge,au as me,av as we,R as ye,b as S,j as M,i as K,A as _,aL as O,aA as V,Q as U,p as be,aP as D,m as q,K as pe}from"./index.f1e91777.js";const[Z,k]=j("swipe"),Te={loop:M,width:K,height:K,vertical:Boolean,autoplay:_(0),duration:_(500),touchable:M,lazyRender:Boolean,initialSwipe:_(0),indicatorColor:String,showIndicators:M,stopPropagation:M},ee=Symbol(Z);var xe=F({name:Z,props:Te,emits:["change"],setup(a,{emit:A,slots:d}){const u=W(),h=W(),e=G({rect:null,width:0,height:0,offset:0,active:0,swiping:!1}),r=ue(),{children:g,linkChildren:z}=re(ee),i=f(()=>g.length),l=f(()=>e[a.vertical?"height":"width"]),s=f(()=>a.vertical?r.deltaY.value:r.deltaX.value),m=f(()=>e.rect?(a.vertical?e.rect.height:e.rect.width)-l.value*i.value:0),E=f(()=>Math.ceil(Math.abs(m.value)/l.value)),b=f(()=>i.value*l.value),C=f(()=>(e.active+i.value)%i.value),R=f(()=>{const t=a.vertical?"vertical":"horizontal";return r.direction.value===t}),te=f(()=>{const t={transitionDuration:`${e.swiping?0:a.duration}ms`,transform:`translate${a.vertical?"Y":"X"}(${e.offset}px)`};if(l.value){const o=a.vertical?"height":"width",n=a.vertical?"width":"height";t[o]=`${b.value}px`,t[n]=a[n]?`${a[n]}px`:""}return t}),ae=t=>{const{active:o}=e;return t?a.loop?D(o+t,-1,i.value):D(o+t,0,E.value):o},B=(t,o=0)=>{let n=t*l.value;a.loop||(n=Math.min(n,-m.value));let v=o-n;return a.loop||(v=D(v,m.value,0)),v},w=({pace:t=0,offset:o=0,emitChange:n})=>{if(i.value<=1)return;const{active:v}=e,c=ae(t),x=B(c,o);if(a.loop){if(g[0]&&x!==m.value){const I=x<m.value;g[0].setOffset(I?b.value:0)}if(g[i.value-1]&&x!==0){const I=x>0;g[i.value-1].setOffset(I?-b.value:0)}}e.active=c,e.offset=x,n&&c!==v&&A("change",C.value)},$=()=>{e.swiping=!0,e.active<=-1?w({pace:i.value}):e.active>=i.value&&w({pace:-i.value})},ie=()=>{$(),r.reset(),O(()=>{e.swiping=!1,w({pace:-1,emitChange:!0})})},Y=()=>{$(),r.reset(),O(()=>{e.swiping=!1,w({pace:1,emitChange:!0})})};let L;const p=()=>clearTimeout(L),T=()=>{p(),a.autoplay>0&&i.value>1&&(L=setTimeout(()=>{Y(),T()},+a.autoplay))},y=(t=+a.initialSwipe)=>{if(!u.value)return;const o=()=>{var n,v;if(!V(u)){const c={width:u.value.offsetWidth,height:u.value.offsetHeight};e.rect=c,e.width=+((n=a.width)!=null?n:c.width),e.height=+((v=a.height)!=null?v:c.height)}i.value&&(t=Math.min(i.value-1,t)),e.active=t,e.swiping=!0,e.offset=B(t),g.forEach(c=>{c.setOffset(0)}),T()};V(u)?U().then(o):o()},N=()=>y(e.active);let X;const ne=t=>{!a.touchable||(r.start(t),X=Date.now(),p(),$())},oe=t=>{a.touchable&&e.swiping&&(r.move(t),R.value&&(!a.loop&&(e.active===0&&s.value>0||e.active===i.value-1&&s.value<0)||(be(t,a.stopPropagation),w({offset:s.value}))))},H=()=>{if(!a.touchable||!e.swiping)return;const t=Date.now()-X,o=s.value/t;if((Math.abs(o)>.25||Math.abs(s.value)>l.value/2)&&R.value){const v=a.vertical?r.offsetY.value:r.offsetX.value;let c=0;a.loop?c=v>0?s.value>0?-1:1:0:c=-Math[s.value>0?"ceil":"floor"](s.value/l.value),w({pace:c,emitChange:!0})}else s.value&&w({pace:0});e.swiping=!1,T()},se=(t,o={})=>{$(),r.reset(),O(()=>{let n;a.loop&&t===i.value?n=e.active===0?0:t:n=t%i.value,o.immediate?O(()=>{e.swiping=!1}):e.swiping=!1,w({pace:n-e.active,emitChange:!0})})},le=(t,o)=>{const n=o===C.value,v=n?{backgroundColor:a.indicatorColor}:void 0;return S("i",{style:v,class:k("indicator",{active:n})},null)},ce=()=>{if(d.indicator)return d.indicator({active:C.value,total:i.value});if(a.showIndicators&&i.value>1)return S("div",{class:k("indicators",{vertical:a.vertical})},[Array(i.value).fill("").map(le)])};return J({prev:ie,next:Y,state:e,resize:N,swipeTo:se}),z({size:l,props:a,count:i,activeIndicator:C}),P(()=>a.initialSwipe,t=>y(+t)),P(i,()=>y(e.active)),P(()=>a.autoplay,T),P([ve,fe],N),P(he(),t=>{t==="visible"?T():p()}),Q(y),de(()=>y(e.active)),ge(()=>y(e.active)),me(p),we(p),ye("touchmove",oe,{target:h}),()=>{var t;return S("div",{ref:u,class:k()},[S("div",{ref:h,style:te.value,class:k("track",{vertical:a.vertical}),onTouchstartPassive:ne,onTouchend:H,onTouchcancel:H},[(t=d.default)==null?void 0:t.call(d)]),ce()])}}});const $e=q(xe),[Pe,Se]=j("swipe-item");var Ae=F({name:Pe,setup(a,{slots:A}){let d;const u=G({offset:0,inited:!1,mounted:!1}),{parent:h,index:e}=pe(ee);if(!h)return;const r=f(()=>{const i={},{vertical:l}=h.props;return h.size.value&&(i[l?"height":"width"]=`${h.size.value}px`),u.offset&&(i.transform=`translate${l?"Y":"X"}(${u.offset}px)`),i}),g=f(()=>{const{loop:i,lazyRender:l}=h.props;if(!l||d)return!0;if(!u.mounted)return!1;const s=h.activeIndicator.value,m=h.count.value-1,E=s===0&&i?m:s-1,b=s===m&&i?0:s+1;return d=e.value===s||e.value===E||e.value===b,d}),z=i=>{u.offset=i};return Q(()=>{U(()=>{u.mounted=!0})}),J({setOffset:z}),()=>{var i;return S("div",{class:Se(),style:r.value},[g.value?(i=A.default)==null?void 0:i.call(A):null])}}});const Me=q(Ae);export{$e as S,Me as a};
