import{h as j,z as O,i as S,ah as D,G as x,d as L,O as w,P as U,ai as V,b as r,Y as T,aj as _,ak as q,V as E,al as G,T as H,C as g,am as Y,m as $,v as A,an as F,r as J,ao as K,ap as Q}from"./index.ee12a00d.js";let f=0;function R(e){e?(f||document.body.classList.add("van-toast--unclickable"),f++):f&&(f--,f||document.body.classList.remove("van-toast--unclickable"))}const[W,m]=j("toast"),X=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay"],Z={icon:String,show:Boolean,type:O("text"),overlay:Boolean,message:S,iconSize:S,duration:D(2e3),position:O("middle"),teleport:[String,Object],className:x,iconPrefix:String,transition:O("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:x,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean};var I=L({name:W,props:Z,emits:["update:show"],setup(e,{emit:t}){let o,u=!1;const i=()=>{const a=e.show&&e.forbidClick;u!==a&&(u=a,R(u))},d=a=>t("update:show",a),k=()=>{e.closeOnClick&&d(!1)},y=()=>clearTimeout(o),C=()=>{const{icon:a,type:l,iconSize:P,iconPrefix:B,loadingType:N}=e;if(a||l==="success"||l==="fail")return r(E,{name:a||l,size:P,class:m("icon"),classPrefix:B},null);if(l==="loading")return r(G,{class:m("loading"),size:P,type:N},null)},c=()=>{const{type:a,message:l}=e;if(H(l)&&l!=="")return a==="html"?r("div",{key:0,class:m("text"),innerHTML:String(l)},null):r("div",{class:m("text")},[l])};return w(()=>[e.show,e.forbidClick],i),w(()=>[e.show,e.type,e.message,e.duration],()=>{y(),e.show&&e.duration>0&&(o=setTimeout(()=>{d(!1)},e.duration))}),U(i),V(i),()=>r(q,T({class:[m([e.position,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:k,onClosed:y,"onUpdate:show":d},_(e,X)),{default:()=>[C(),c()]})}});const M={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let n=[],h=!1,v=g({},M);const p=new Map;function z(e){return A(e)?e:{message:e}}function ee(){const{instance:e,unmount:t}=F({setup(){const o=J(""),{open:u,state:i,close:d,toggle:k}=K(),y=()=>{h&&(n=n.filter(c=>c!==e),t())},C=()=>r(I,T(i,{onClosed:y,"onUpdate:show":k}),null);return w(o,c=>{i.message=c}),Q().render=C,{open:u,clear:d,message:o}}});return e}function te(){if(!n.length||h){const e=ee();n.push(e)}return n[n.length-1]}function s(e={}){if(!Y)return{};const t=te(),o=z(e);return t.open(g({},v,p.get(o.type||v.type),o)),t}const b=e=>t=>s(g({type:e},z(t)));s.loading=b("loading");s.success=b("success");s.fail=b("fail");s.clear=e=>{var t;n.length&&(e?(n.forEach(o=>{o.clear()}),n=[]):h?(t=n.shift())==null||t.clear():n[0].clear())};function ne(e,t){typeof e=="string"?p.set(e,t):g(v,e)}s.setDefaultOptions=ne;s.resetDefaultOptions=e=>{typeof e=="string"?p.delete(e):(v=g({},M),p.clear())};s.allowMultiple=(e=!0)=>{h=e};s.install=e=>{e.use($(I)),e.config.globalProperties.$toast=s};export{s as T};
